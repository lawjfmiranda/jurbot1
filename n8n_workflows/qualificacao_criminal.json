{
  "name": "Qualifica√ß√£o - A√ß√£o Penal e Criminal",
  "nodes": [
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "qualificacao_criminal",
        "responseMode": "responseNode",
        "options": {}
      },
      "id": "webhook-criminal",
      "name": "Webhook Criminal",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 1,
      "position": [240, 300]
    },
    {
      "parameters": {
        "jsCode": "// Processar caso criminal - JM ADVOGADOS especialista\nconst inputData = $input.all()[0].json;\n\nconst userNumber = inputData.user_number;\nconst message = inputData.message.toLowerCase();\nconst clientInfo = inputData.client_info || {};\n\nconsole.log('‚öñÔ∏è Processando caso criminal para:', userNumber);\n\n// Identificar subtipo criminal espec√≠fico\nlet subtype = 'geral';\nlet urgency = 'normal';\nlet phase = 'inicial';\nlet specificQuestions = [];\nlet drJMSpecialty = false; // Indica se √© √°rea de especialidade do Dr. JM\n\n// FLAGRANTE - URGENT√çSSIMO\nif (message.includes('preso') || message.includes('flagrante') || message.includes('cust√≥dia')) {\n  subtype = 'flagrante';\n  urgency = 'urgentissimo';\n  phase = 'flagrante';\n  drJMSpecialty = true;\n  specificQuestions = [\n    'Onde est√° preso?',\n    'Quando foi a pris√£o?',\n    'J√° teve audi√™ncia de cust√≥dia?',\n    'Qual o crime alegado?'\n  ];\n}\n\n// INQU√âRITO POLICIAL\nelse if (message.includes('inqu√©rito') || message.includes('delegacia') || message.includes('investiga√ß√£o')) {\n  subtype = 'inquerito';\n  urgency = 'alta';\n  phase = 'policial';\n  drJMSpecialty = true;\n  specificQuestions = [\n    'Foi intimado como suspeito ou testemunha?',\n    'Qual delegacia?',\n    'J√° prestou depoimento?',\n    'Tem advogado acompanhando?'\n  ];\n}\n\n// PROCESSO CRIMINAL EM ANDAMENTO\nelse if (message.includes('processo') || message.includes('audi√™ncia') || message.includes('julgamento')) {\n  subtype = 'processo';\n  urgency = 'alta';\n  phase = 'processual';\n  drJMSpecialty = true;\n  specificQuestions = [\n    'Em que fase est√° o processo?',\n    'Tem advogado constitu√≠do?',\n    'Pr√≥xima audi√™ncia marcada?',\n    'Qual vara criminal?'\n  ];\n}\n\n// RECURSOS - Especialidade Dr. JM\nelse if (message.includes('recurso') || message.includes('apela√ß√£o') || message.includes('condenado')) {\n  subtype = 'recurso';\n  urgency = 'alta';\n  phase = 'recursal';\n  drJMSpecialty = true;\n  specificQuestions = [\n    'Qual foi a senten√ßa?',\n    'Quando foi publicada?',\n    'Qual o prazo para recurso?',\n    'Tem as pe√ßas do processo?'\n  ];\n}\n\n// CRIMES ESPEC√çFICOS\nelse if (message.includes('droga') || message.includes('tr√°fico')) {\n  subtype = 'drogas';\n  urgency = 'alta';\n  drJMSpecialty = true;\n}\nelse if (message.includes('roubo') || message.includes('furto')) {\n  subtype = 'patrimonio';\n  urgency = 'normal';\n  drJMSpecialty = true;\n}\nelse if (message.includes('homic√≠dio') || message.includes('les√£o')) {\n  subtype = 'violento';\n  urgency = 'urgente';\n  drJMSpecialty = true;\n}\n\n// Gerar resposta espec√≠fica do Dr. JM\nlet response = '';\n\nswitch(subtype) {\n  case 'flagrante':\n    response = `üö® PRIS√ÉO EM FLAGRANTE - URG√äNCIA M√ÅXIMA\\n\\nDr. JM Miranda, criminalista especialista, vai atuar IMEDIATAMENTE.\\n\\n‚ö° A√á√ÉO URGENTE:\\n‚Ä¢ Habeas Corpus preventivo\\n‚Ä¢ Acompanhamento na delegacia\\n‚Ä¢ Audi√™ncia de cust√≥dia\\n‚Ä¢ Liberdade provis√≥ria\\n\\nüìã Informa√ß√µes URGENTES:\\n${specificQuestions.map((q, i) => `${i+1}. ${q}`).join('\\n')}\\n\\nüî¥ ATEN√á√ÉO: Flagrante tem 24h para audi√™ncia!\\n\\nüìû CONTATO IMEDIATO: Dr. JM j√° est√° sendo acionado!`;\n    break;\n    \n  case 'inquerito':\n    response = `üîç INVESTIGA√á√ÉO POLICIAL\\n\\nDr. JM Miranda, especialista em fase policial, vai te orientar.\\n\\n‚úÖ Acompanhamento especializado:\\n‚Ä¢ Assessoria em depoimentos\\n‚Ä¢ Medidas cautelares\\n‚Ä¢ Controle de investiga√ß√£o\\n‚Ä¢ Defesa preventiva\\n\\nüìã Situa√ß√£o atual:\\n${specificQuestions.map((q, i) => `${i+1}. ${q}`).join('\\n')}\\n\\n‚öñÔ∏è IMPORTANTE: Fase policial √© crucial para sua defesa!\\n\\nüìû Dr. JM precisa analisar seu caso HOJE!`;\n    break;\n    \n  case 'processo':\n    response = `‚öñÔ∏è PROCESSO CRIMINAL EM ANDAMENTO\\n\\nDr. JM Miranda, professor de processo penal, assume sua defesa.\\n\\n‚úÖ Defesa t√©cnica especializada:\\n‚Ä¢ An√°lise processual completa\\n‚Ä¢ Estrat√©gia de defesa\\n‚Ä¢ Sustenta√ß√£o oral\\n‚Ä¢ Acompanhamento em audi√™ncias\\n\\nüìã Status processual:\\n${specificQuestions.map((q, i) => `${i+1}. ${q}`).join('\\n')}\\n\\nüéì Dr. JM: Professor de Direito Penal e Processo Penal\\n\\nüìû Vamos analisar sua defesa estrat√©gica!`;\n    break;\n    \n  case 'recurso':\n    response = `üìú RECURSOS CRIMINAIS - Especialidade Dr. JM\\n\\nCoordenador do Curso de Direito, especialista em recursos.\\n\\n‚úÖ Recursos especializados:\\n‚Ä¢ Apela√ß√£o criminal\\n‚Ä¢ Embargos de declara√ß√£o\\n‚Ä¢ Recurso em sentido estrito\\n‚Ä¢ Habeas Corpus\\n\\nüìã Dados do recurso:\\n${specificQuestions.map((q, i) => `${i+1}. ${q}`).join('\\n')}\\n\\n‚è∞ ATEN√á√ÉO: Prazos recursais s√£o improrrog√°veis!\\n\\nüìû Dr. JM precisa analisar URGENTE!`;\n    break;\n    \n  case 'drogas':\n    response = `üåø CRIME DE DROGAS\\n\\nDr. JM Miranda, criminalista com vasta experi√™ncia em entorpecentes.\\n\\n‚úÖ Defesa especializada:\\n‚Ä¢ An√°lise da materialidade\\n‚Ä¢ Questionamento da autoria\\n‚Ä¢ Desclassifica√ß√£o tr√°fico/uso\\n‚Ä¢ Medidas alternativas\\n\\nüéØ Estrat√©gias poss√≠veis:\\n‚Ä¢ Trancamento de inqu√©rito\\n‚Ä¢ Relaxamento de pris√£o\\n‚Ä¢ Suspens√£o condicional\\n‚Ä¢ Redu√ß√£o de pena\\n\\nüìû Dr. JM vai analisar todas as possibilidades!`;\n    break;\n    \n  default:\n    response = `‚öñÔ∏è CASO CRIMINAL\\n\\nDr. JM Miranda, criminalista e professor de direito penal.\\n\\nüéì Especialidades:\\n‚Ä¢ Defesa criminal em todas as fases\\n‚Ä¢ Professor de Direito Penal\\n‚Ä¢ Processo Penal Aplicado\\n‚Ä¢ Investiga√ß√£o Criminal\\n‚Ä¢ Psicologia Forense\\n\\n‚úÖ Atua√ß√£o completa:\\n‚Ä¢ Flagrantes e cust√≥dias\\n‚Ä¢ Inqu√©ritos policiais\\n‚Ä¢ Processos criminais\\n‚Ä¢ Recursos especializados\\n\\nüìû Dr. JM vai analisar seu caso criminal!`;\n}\n\n// Resultado\nconst result = {\n  user_number: userNumber,\n  case_type: 'criminal',\n  subtype: subtype,\n  urgency: urgency,\n  phase: phase,\n  dr_jm_specialty: drJMSpecialty,\n  specific_questions: specificQuestions,\n  response: response,\n  needs_immediate_contact: urgency === 'urgentissimo',\n  priority_contact: urgency !== 'normal',\n  processed_at: new Date().toISOString()\n};\n\nconsole.log('üì§ Criminal processado:', result);\n\nreturn result;"
      },
      "id": "process-criminal",
      "name": "Processar Criminal",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [440, 300]
    },
    {
      "parameters": {
        "conditions": {
          "string": [
            {
              "value1": "={{ $json.urgency }}",
              "operation": "equal",
              "value2": "urgentissimo"
            }
          ]
        }
      },
      "id": "check-urgency-criminal",
      "name": "Verificar Urg√™ncia Criminal",
      "type": "n8n-nodes-base.if",
      "typeVersion": 1,
      "position": [640, 300]
    },
    {
      "parameters": {
        "respondWith": "json",
        "responseBody": "={{ $json }}"
      },
      "id": "response-urgent-criminal",
      "name": "Resposta Urgent√≠ssima",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1,
      "position": [840, 200]
    },
    {
      "parameters": {
        "respondWith": "json", 
        "responseBody": "={{ $json }}"
      },
      "id": "response-normal-criminal",
      "name": "Resposta Normal Criminal",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1,
      "position": [840, 400]
    }
  ],
  "connections": {
    "Webhook Criminal": {
      "main": [
        [
          {
            "node": "Processar Criminal",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Processar Criminal": {
      "main": [
        [
          {
            "node": "Verificar Urg√™ncia Criminal",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Verificar Urg√™ncia Criminal": {
      "main": [
        [
          {
            "node": "Resposta Urgent√≠ssima",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Resposta Normal Criminal",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": true,
  "settings": {},
  "versionId": "1"
}
