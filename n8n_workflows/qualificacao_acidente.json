{
  "name": "QualificaÃ§Ã£o - Acidentes e Responsabilidade Civil",
  "nodes": [
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "qualificacao_acidente",
        "responseMode": "responseNode",
        "options": {}
      },
      "id": "webhook-acidente",
      "name": "Webhook Acidente",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 1,
      "position": [240, 300]
    },
    {
      "parameters": {
        "jsCode": "// Processar caso de acidente/responsabilidade civil\nconst inputData = $input.all()[0].json;\n\nconst userNumber = inputData.user_number;\nconst message = inputData.message.toLowerCase();\nconst clientInfo = inputData.client_info || {};\n\nconsole.log('ğŸš— Processando caso de acidente para:', userNumber);\n\n// Identificar tipo de acidente\nlet accidentType = 'geral';\nlet severity = 'leve';\nlet estimatedValue = 'baixo';\nlet specificQuestions = [];\n\n// Acidente de trÃ¢nsito\nif (message.includes('carro') || message.includes('trÃ¢nsito') || message.includes('bateu') || message.includes('colisÃ£o')) {\n  accidentType = 'transito';\n  specificQuestions = [\n    'Houve vÃ­timas/feridos?',\n    'Foi feito boletim de ocorrÃªncia?',\n    'Tem seguro do veÃ­culo?',\n    'Quem foi o culpado?'\n  ];\n  \n  // Verificar gravidade\n  if (message.includes('morte') || message.includes('grave') || message.includes('hospital')) {\n    severity = 'grave';\n    estimatedValue = 'alto';\n  }\n}\n\n// Acidente de trabalho\nelse if (message.includes('trabalho') || message.includes('empresa') || message.includes('mÃ¡quina')) {\n  accidentType = 'trabalho';\n  specificQuestions = [\n    'Houve afastamento?',\n    'Foi comunicado Ã  empresa?',\n    'HÃ¡ testemunhas?',\n    'Qual o tipo de lesÃ£o?'\n  ];\n  \n  if (message.includes('grave') || message.includes('incapacit')) {\n    severity = 'grave';\n    estimatedValue = 'alto';\n  }\n}\n\n// Erro mÃ©dico\nelse if (message.includes('mÃ©dico') || message.includes('hospital') || message.includes('cirurgia')) {\n  accidentType = 'medico';\n  severity = 'grave'; // Sempre considerado grave\n  estimatedValue = 'alto';\n  specificQuestions = [\n    'Qual foi o procedimento?',\n    'Tem documentos mÃ©dicos?',\n    'Houve sequelas?',\n    'Foi em hospital pÃºblico ou privado?'\n  ];\n}\n\n// Queda/acidente em local pÃºblico\nelse if (message.includes('queda') || message.includes('caiu') || message.includes('buraco')) {\n  accidentType = 'queda';\n  specificQuestions = [\n    'Onde aconteceu a queda?',\n    'HÃ¡ testemunhas?',\n    'Foi fotografado o local?',\n    'Houve atendimento mÃ©dico?'\n  ];\n}\n\n// Produto defeituoso\nelse if (message.includes('produto') || message.includes('defeito') || message.includes('explodiu')) {\n  accidentType = 'produto';\n  specificQuestions = [\n    'Qual produto causou o dano?',\n    'Tem nota fiscal?',\n    'Guardou o produto defeituoso?',\n    'Qual foi o dano causado?'\n  ];\n}\n\n// Calcular prioridade baseada na gravidade\nlet priority = 'normal';\nif (severity === 'grave') {\n  priority = 'alta';\n}\n\n// Gerar resposta especÃ­fica\nlet response = '';\n\nswitch(accidentType) {\n  case 'transito':\n    const transitSeverity = severity === 'grave' ? 'ğŸš¨ CASO GRAVE IDENTIFICADO' : 'Acidente de trÃ¢nsito';\n    response = `ğŸš— ${transitSeverity}\\n\\nVamos cuidar da sua indenizaÃ§Ã£o por acidente de trÃ¢nsito.\\n\\nâœ… Podemos buscar:\\nâ€¢ IndenizaÃ§Ã£o por danos materiais\\nâ€¢ Danos morais\\nâ€¢ Lucros cessantes\\nâ€¢ Despesas mÃ©dicas\\nâ€¢ PensÃ£o (em casos graves)\\n\\nğŸ“‹ InformaÃ§Ãµes importantes:\\n${specificQuestions.map((q, i) => `${i+1}. ${q}`).join('\\n')}\\n\\nğŸ’° Estimativa: Caso de ${estimatedValue} valor\\n\\nğŸ“ ${severity === 'grave' ? 'URGENTE: Vou priorizar seu caso!' : 'Vamos agendar uma consulta?'}`;\n    break;\n    \n  case 'trabalho':\n    response = `âš’ï¸ Acidente de trabalho identificado.\\n\\nSeus direitos trabalhistas serÃ£o protegidos.\\n\\nâœ… Podemos buscar:\\nâ€¢ IndenizaÃ§Ã£o por acidente\\nâ€¢ AuxÃ­lio-doenÃ§a acidentÃ¡rio\\nâ€¢ Aposentadoria por invalidez\\nâ€¢ Estabilidade no emprego\\nâ€¢ Danos morais\\n\\nğŸ“‹ Dados necessÃ¡rios:\\n${specificQuestions.map((q, i) => `${i+1}. ${q}`).join('\\n')}\\n\\nâš–ï¸ ${severity === 'grave' ? 'Caso grave: Vou agilizar sua consulta!' : 'Vamos analisar seu caso?'}`;\n    break;\n    \n  case 'medico':\n    response = `ğŸ¥ ERRO MÃ‰DICO - Caso especializado\\n\\nErros mÃ©dicos exigem anÃ¡lise tÃ©cnica detalhada.\\n\\nâœ… Nossa atuaÃ§Ã£o:\\nâ€¢ AnÃ¡lise por mÃ©dico especialista\\nâ€¢ IndenizaÃ§Ã£o por danos\\nâ€¢ ResponsabilizaÃ§Ã£o profissional\\nâ€¢ Suporte psicolÃ³gico\\n\\nğŸ“‹ Documentos importantes:\\n${specificQuestions.map((q, i) => `${i+1}. ${q}`).join('\\n')}\\n\\nğŸ©º IMPORTANTE: Casos mÃ©dicos tÃªm alta complexidade\\n\\nğŸ“ Vou agendar com nossa especialista em erro mÃ©dico!`;\n    break;\n    \n  case 'queda':\n    response = `ğŸš§ Acidente por queda em local pÃºblico/privado.\\n\\nVamos responsabilizar o local inadequado.\\n\\nâœ… Podemos buscar:\\nâ€¢ IndenizaÃ§Ã£o do responsÃ¡vel\\nâ€¢ Danos morais e materiais\\nâ€¢ Despesas mÃ©dicas\\nâ€¢ Lucros cessantes\\n\\nğŸ“‹ EvidÃªncias importantes:\\n${specificQuestions.map((q, i) => `${i+1}. ${q}`).join('\\n')}\\n\\nğŸ“¸ DICA: Fotografe sempre o local do acidente!\\n\\nğŸ“ Vamos avaliar a responsabilidade?`;\n    break;\n    \n  case 'produto':\n    response = `ğŸ“¦ Produto defeituoso - Direito do Consumidor\\n\\nFabricantes devem responder por produtos defeituosos.\\n\\nâœ… Seus direitos:\\nâ€¢ IndenizaÃ§Ã£o integral\\nâ€¢ Danos morais\\nâ€¢ Troca do produto\\nâ€¢ Despesas mÃ©dicas\\n\\nğŸ“‹ Documentos essenciais:\\n${specificQuestions.map((q, i) => `${i+1}. ${q}`).join('\\n')}\\n\\nâš–ï¸ CDC te protege contra produtos defeituosos!\\n\\nğŸ“ Vamos processar o fabricante?`;\n    break;\n    \n  default:\n    response = `âš–ï¸ Caso de responsabilidade civil identificado.\\n\\nVamos analisar quem deve te indenizar.\\n\\nâœ… Atuamos em:\\nâ€¢ Acidentes de trÃ¢nsito\\nâ€¢ Acidentes de trabalho\\nâ€¢ Erro mÃ©dico\\nâ€¢ Queda em locais pÃºblicos\\nâ€¢ Produtos defeituosos\\n\\nğŸ’° Todo dano merece reparaÃ§Ã£o!\\n\\nğŸ“ Vamos avaliar seu caso?`;\n}\n\n// Resultado\nconst result = {\n  user_number: userNumber,\n  case_type: 'acidente',\n  accident_type: accidentType,\n  severity: severity,\n  priority: priority,\n  estimated_value: estimatedValue,\n  specific_questions: specificQuestions,\n  response: response,\n  requires_expert_analysis: accidentType === 'medico' || severity === 'grave',\n  processed_at: new Date().toISOString()\n};\n\nconsole.log('ğŸ“¤ Acidente processado:', result);\n\nreturn result;"
      },
      "id": "process-acidente",
      "name": "Processar Acidente",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [440, 300]
    },
    {
      "parameters": {
        "respondWith": "json",
        "responseBody": "={{ $json }}"
      },
      "id": "response-acidente",
      "name": "Resposta Acidente",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1,
      "position": [640, 300]
    }
  ],
  "connections": {
    "Webhook Acidente": {
      "main": [
        [
          {
            "node": "Processar Acidente",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Processar Acidente": {
      "main": [
        [
          {
            "node": "Resposta Acidente",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": true,
  "settings": {},
  "versionId": "1"
}
