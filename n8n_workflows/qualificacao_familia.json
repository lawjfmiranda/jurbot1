{
  "name": "QualificaÃ§Ã£o - Direito de FamÃ­lia",
  "nodes": [
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "qualificacao_familia",
        "responseMode": "responseNode",
        "options": {}
      },
      "id": "webhook-familia",
      "name": "Webhook FamÃ­lia",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 1,
      "position": [240, 300]
    },
    {
      "parameters": {
        "jsCode": "// Processar caso de direito de famÃ­lia\nconst inputData = $input.all()[0].json;\n\nconst userNumber = inputData.user_number;\nconst message = inputData.message.toLowerCase();\nconst clientInfo = inputData.client_info || {};\n\nconsole.log('ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ Processando caso de famÃ­lia para:', userNumber);\n\n// Identificar subtipo especÃ­fico\nlet subtype = 'geral';\nlet urgency = 'normal';\nlet specificQuestions = [];\n\n// DivÃ³rcio\nif (message.includes('divÃ³rcio') || message.includes('divorcio') || message.includes('separar')) {\n  subtype = 'divorcio';\n  specificQuestions = [\n    'VocÃªs tÃªm filhos menores?',\n    'HÃ¡ bens a partilhar?',\n    'O divÃ³rcio Ã© consensual?'\n  ];\n}\n\n// Guarda\nelse if (message.includes('guarda') || message.includes('visita')) {\n  subtype = 'guarda';\n  specificQuestions = [\n    'Quantos filhos estÃ£o envolvidos?',\n    'Qual a idade das crianÃ§as?',\n    'HÃ¡ acordo sobre visitas?'\n  ];\n}\n\n// PensÃ£o\nelse if (message.includes('pensÃ£o') || message.includes('pensao') || message.includes('alimento')) {\n  subtype = 'pensao';\n  specificQuestions = [\n    'Qual a renda do pagador?',\n    'Quantos dependentes?',\n    'HÃ¡ atraso nos pagamentos?'\n  ];\n  \n  // PensÃ£o em atraso Ã© urgente\n  if (message.includes('nÃ£o paga') || message.includes('atraso')) {\n    urgency = 'alta';\n  }\n}\n\n// ViolÃªncia domÃ©stica\nelse if (message.includes('violÃªncia') || message.includes('agressÃ£o') || message.includes('ameaÃ§a')) {\n  subtype = 'violencia';\n  urgency = 'urgente';\n  specificQuestions = [\n    'VocÃª estÃ¡ em local seguro?',\n    'JÃ¡ registrou boletim de ocorrÃªncia?',\n    'Precisa de medida protetiva?'\n  ];\n}\n\n// Gerar resposta especÃ­fica\nlet response = '';\n\nswitch(subtype) {\n  case 'divorcio':\n    response = `ğŸ’” Compreendo que vocÃª quer se divorciar.\\n\\nVou te conectar com nossa especialista em divÃ³rcio, Dra. Ana.\\n\\nâœ… Podemos ajudar com:\\nâ€¢ DivÃ³rcio consensual ou litigioso\\nâ€¢ Partilha de bens\\nâ€¢ Guarda dos filhos\\nâ€¢ PensÃ£o alimentÃ­cia\\n\\nğŸ“‹ Para agilizar sua consulta:\\n${specificQuestions.map((q, i) => `${i+1}. ${q}`).join('\\n')}\\n\\nğŸ“ Vamos agendar uma consulta especializada?`;\n    break;\n    \n  case 'guarda':\n    response = `ğŸ‘¶ QuestÃµes de guarda precisam de cuidado especial.\\n\\nNossa equipe prioriza sempre o bem-estar das crianÃ§as.\\n\\nâœ… Atuamos em:\\nâ€¢ Guarda unilateral e compartilhada\\nâ€¢ RegulamentaÃ§Ã£o de visitas\\nâ€¢ MudanÃ§a de guarda\\nâ€¢ AlienaÃ§Ã£o parental\\n\\nğŸ“‹ InformaÃ§Ãµes importantes:\\n${specificQuestions.map((q, i) => `${i+1}. ${q}`).join('\\n')}\\n\\nğŸ‘¨â€âš–ï¸ Quer uma consulta com nossa especialista?`;\n    break;\n    \n  case 'pensao':\n    const urgencyText = urgency === 'alta' ? 'ğŸš¨ URGENTE: ' : '';\n    response = `ğŸ’° ${urgencyText}QuestÃµes de pensÃ£o alimentÃ­cia.\\n\\nVamos resolver sua situaÃ§Ã£o rapidamente.\\n\\nâœ… Podemos ajudar com:\\nâ€¢ AÃ§Ã£o de alimentos\\nâ€¢ RevisÃ£o de pensÃ£o\\nâ€¢ ExecuÃ§Ã£o de alimentos\\nâ€¢ PrisÃ£o por nÃ£o pagamento\\n\\nğŸ“‹ Dados importantes:\\n${specificQuestions.map((q, i) => `${i+1}. ${q}`).join('\\n')}\\n\\nâš–ï¸ ${urgency === 'alta' ? 'Vou priorizar seu caso!' : 'Vamos agendar uma consulta?'}`;\n    break;\n    \n  case 'violencia':\n    response = `ğŸš¨ SITUAÃ‡ÃƒO DE URGÃŠNCIA IDENTIFICADA\\n\\nSua seguranÃ§a Ã© nossa prioridade absoluta.\\n\\nâœ… AÃ§Ã£o imediata:\\nâ€¢ Medida protetiva de urgÃªncia\\nâ€¢ Acompanhamento policial\\nâ€¢ OrientaÃ§Ã£o jurÃ­dica completa\\nâ€¢ Suporte psicolÃ³gico\\n\\nğŸ“‹ InformaÃ§Ãµes urgentes:\\n${specificQuestions.map((q, i) => `${i+1}. ${q}`).join('\\n')}\\n\\nğŸ“ CONTATO IMEDIATO: Vou conectar vocÃª AGORA com nossa especialista em violÃªncia domÃ©stica!\\n\\nğŸ†˜ Em emergÃªncia, ligue 190`;\n    break;\n    \n  default:\n    response = `ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ QuestÃ£o de direito de famÃ­lia identificada.\\n\\nVamos analisar seu caso com todo cuidado.\\n\\nâœ… Ãreas de atuaÃ§Ã£o:\\nâ€¢ DivÃ³rcio e separaÃ§Ã£o\\nâ€¢ Guarda e visitaÃ§Ã£o\\nâ€¢ PensÃ£o alimentÃ­cia\\nâ€¢ UniÃ£o estÃ¡vel\\nâ€¢ AdoÃ§Ã£o\\n\\nğŸ“ Gostaria de agendar uma consulta especializada?`;\n}\n\n// Resultado\nconst result = {\n  user_number: userNumber,\n  case_type: 'familia',\n  subtype: subtype,\n  urgency: urgency,\n  specific_questions: specificQuestions,\n  response: response,\n  needs_immediate_contact: urgency === 'urgente',\n  processed_at: new Date().toISOString()\n};\n\nconsole.log('ğŸ“¤ FamÃ­lia processada:', result);\n\nreturn result;"
      },
      "id": "process-familia",
      "name": "Processar FamÃ­lia",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [440, 300]
    },
    {
      "parameters": {
        "conditions": {
          "string": [
            {
              "value1": "={{ $json.urgency }}",
              "operation": "equal",
              "value2": "urgente"
            }
          ]
        }
      },
      "id": "check-urgency",
      "name": "Verificar UrgÃªncia",
      "type": "n8n-nodes-base.if",
      "typeVersion": 1,
      "position": [640, 300]
    },
    {
      "parameters": {
        "respondWith": "json",
        "responseBody": "={{ $json }}"
      },
      "id": "response-urgent",
      "name": "Resposta Urgente",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1,
      "position": [840, 200]
    },
    {
      "parameters": {
        "respondWith": "json", 
        "responseBody": "={{ $json }}"
      },
      "id": "response-normal",
      "name": "Resposta Normal",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1,
      "position": [840, 400]
    }
  ],
  "connections": {
    "Webhook FamÃ­lia": {
      "main": [
        [
          {
            "node": "Processar FamÃ­lia",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Processar FamÃ­lia": {
      "main": [
        [
          {
            "node": "Verificar UrgÃªncia",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Verificar UrgÃªncia": {
      "main": [
        [
          {
            "node": "Resposta Urgente",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Resposta Normal",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": true,
  "settings": {},
  "versionId": "1"
}
